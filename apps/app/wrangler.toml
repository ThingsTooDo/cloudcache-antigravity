name = "app-worker"
main = "dist/index.js"
compatibility_date = "2025-10-07"

# Production routes
routes = [
  { pattern = "app.cloudcache.ai/*", zone_name = "cloudcache.ai" }
]

# Remote bindings for local dev (no .dev.vars needed)
# Note: remote bindings are enabled by default in Wrangler v4
[dev]
port = 8789

# Production KV namespace
[[kv_namespaces]]
binding = "APP_KV"
id = "0b01afadb4984342a5e0ef09d7ff5fcd"

# Staging environment
[env.staging]
name = "app-worker-staging"
routes = [
  { pattern = "staging-app.cloudcache.ai/*", zone_name = "cloudcache.ai" }
]

[[env.staging.kv_namespaces]]
binding = "APP_KV"
id = "5df224d061fb4f869a1a713f1ebd7252"

# Preview environment
[env.preview]
name = "app-worker-preview"
# Preview has no routes - uses workers.dev subdomain
routes = []
workers_dev = true

[[env.preview.kv_namespaces]]
binding = "APP_KV"
id = "58050e98476b42578f917f32582b6647"
